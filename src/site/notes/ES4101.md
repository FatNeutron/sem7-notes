---
{"dg-publish":true,"permalink":"/es-4101/","created":"2025-08-07T19:24:14.421+05:30","updated":"2025-08-11T19:01:08.964+05:30"}
---

# Marking Scheme

- **10 Marks:** 1 assignment
- **20 Marks:** 2 class tests; 1 after and 1 before midsem.
- **20 Marks:** midsem
- **50 Marks:** endsem

---

# Inverse Theory

**Inverse theory**, involves using mathematical techniques to solve problems where we only have the results or outcomes of a system, but not the details about how it works. It's like trying to figure out the cause of something by looking at its effects. In math, this often involves equations where we have to work backwards, starting with observed data, and then apply algorithms or methods to estimate the unknown factors. The goal is to find the best possible explanation or model that matches the data we have.

*Forward problem:*
model parameters ⟶ model ⟶prediction of data

*Inverse problem:*
data ⟶ model ⟶ estimate of model parameters

## Describing Inverse Problem

Let's assume a model with these linear equations,

$$
x_1 + x_2 = 1 \tag{1}
$$
$$
x_1 - x_2 = 2 \tag{2}
$$
we can express this in matrix form as, 

$$
\begin{bmatrix}
1 & 1 \\
1 & -1
\end{bmatrix}
\begin{bmatrix}
x_1 \\
x_2
\end{bmatrix}
=
\begin{bmatrix}
1 \\
2
\end{bmatrix}
\tag{3}
$$
 
We define matrices,

data: $d = \begin{bmatrix} d_1 \\ d_2 \\ d_3 \\ \vdots \\ d_N \end{bmatrix}$ , for $N$ number of data obtained.
model parameters: $m = \begin{bmatrix} m_1 \\ m_2 \\ m_3 \\ \vdots \\ m_M \end{bmatrix}$ , when $M$ number of info is available. 

so we can label the equation 3 as,

$$
G \cdot m = d \tag{5}
$$
i.e.,
$$
\underbrace{
\begin{bmatrix}
1 & 1 \\
1 & -1
\end{bmatrix}}_{G}
\underbrace{
\begin{bmatrix}
x_1 \\
x_2
\end{bmatrix}}_{m}
=
\underbrace{
\begin{bmatrix}
1 \\
2
\end{bmatrix}}_{d}
\tag{6}
$$
Here $G$ is a relation matrix, which tell the relation between the unknown parameters and data. 

Based on the number of info available and number of unknown parameters, we can have 3 cases.

### Even determined problem

When the number of unknown parameters are **same** as the information available.

> [!Example]
> Assume a model with these equations,
> $$
> m_1 + m_2 = 1
> $$
> $$
> m_1 - m_2 = -1
> $$
> here number of unknown parameters($m_1,m_2$) and number of information(equations) are same. Hence a **Even determined problem**.

### Over-determined problem

When the number of unknown parameters are **less than** the number of information, it's a over-determined problem.

> [!Example]
> Assume a model with these equations,
> 
> $$
> m_1 + m_2 = 1
> $$
> $$
> m_1 - m_2 = -1
> $$
> $$
> 3m_1 + 2m_2 = 4
> $$
> $$
> 4m_1 - m_2 = 8
> $$
> here, number of unknown parameters(2) < number of equations(4), hence a **over-determined problem**.

### Under-determined problem

When the number of unknown parameters are **more than** the number of information, it's a under-determined problem.

> [!Example]
> Assume a model with these equations,
> 
> $$
> m_1 + 3m_2 - 2m_3 + 17m_4 = 69
> $$
> $$
> 6m_1 - 2m_2 - m_3 + m_4 = 13
> $$
> here, number of unknown parameters(4) > number of equations(2), hence a **under-determined problem**.

# Solving Over-determined problem

First let us define some term,

$d^{obs}_{i}$ : $i$th observed data
$d^{pre}_{i}$ : $i$th predicted data by the model

$e_i = |d^{obs}_{i} - d^{pre}_{i}|$ : prediction error
$E = \sum_{i=1}^{i=N} e^{2}_{i}$ : length norm

To graphically show these terms assume the model to of straight line of form $T_i = m_1 + m_2Z_i$,
![1.png](/img/user/ES4101-img/1.png)
$d_1,d_2, \dots, d_5$ are observed data, $d^{obs}_{i}$.

We need to minimize the error, $E$. Minimizing this problem mean just to reduce the sum of area of squares with length of $e_i$. (Least square method.)
![2.png](/img/user/ES4101-img/2.png)
To do that we can $\frac{\partial{E}}{\partial{m}} = 0$. So,

$$
E = \sum_{i=1}^{N} e_i^2
$$
$$
E = \sum_{i=1}^{N} (d^{obs}_{i} - d^{pre}_{i})^2
$$
$$
E = \sum_{i=1}^{N} (d^{obs}_{i} - (m_1 + m_2Z_i))^2
$$
$$
E = \sum_{i=1}^{N} (d_i - m_1 - m_2Z_i)^2
$$
We need to minimize the error so,
$$
\frac{\partial{E}}{\partial{m_1}} =0= -2\sum_{i=1}^{N} (d_i - m_1 - m_2Z_i)
$$
$$
\sum_{i = 1}^N d_i = Nm_1 + m_2\sum Z_i \tag{7}
$$
also for $m_2$,
$$
\frac{\partial{E}}{\partial{m_2}} =0= -2\sum_{i=1}^{N}Z_i (d_i - m_1 - m_2Z_i)
$$
$$
\sum_{i=1}^{N} d_iZ_i - Nm_1\sum_{i=1}^{N}Z_i - m_2\sum_{i=1}^{N}Z_i^2 = 0
$$
$$
\sum_{i=1}^{N} d_iZ_i = Nm_1\sum_{i=1}^{N}Z_i + m_2\sum_{i=1}^{N}Z_i^2 \tag{8}
$$
In the matrix format we can equation (7) & as equation (8) as,

$$
\underbrace{\begin{bmatrix}
N & \sum_{i=1}^{N} Z_i \\
\sum_{i=1}^{N} Z_i & \sum_{i=1}^{N} Z_i^2
\end{bmatrix}}_{G^TG}

\underbrace{\begin{bmatrix}
m_1 \\m_2
\end{bmatrix}}_m
=
\underbrace{\begin{bmatrix}
\sum_{i=1}^{N}d_i \\ \sum_{i=1}^{N} d_i Z_i
\end{bmatrix}}_{G^Td}
$$
from this we can get unknown parameters,
$$
(G^TG)m_{LS} = G^Td
$$
$$
\boxed{m_{LS} = (G^TG)^{-1}(G^Td), \quad for \quad |G^TG| \neq 0
} \tag{9}
$$

## General approach

Assume we have a $G$ matrix which has relation of data, $d$ and unknown parameters, $m$ given as,

$$
Gm =d
$$
$$
\begin{bmatrix}
G_{11} & G_{12} & \dots \\
G_{21} & \ddots & \ddots \\
\vdots & \ddots & 
\end{bmatrix} 
\begin{bmatrix}
m_1 \\ m_2 \\ \vdots
\end{bmatrix} 
=
\begin{bmatrix}
d_1 \\ d_2 \\ \vdots
\end{bmatrix} 

$$
we have, 
$$
E =  e^Te = \sum_{i = 1} e_i^2
$$
$$
E = \sum_{i=1}(d_i - \sum_{j=1}G_{ij}m_j)^2
$$
so,
$$
\frac{\partial{E}}{\partial{m_q}} = 2\sum_{i=1} \left(d_i - \sum_{j=1}G_{ij}m_j\right) \frac{\partial}{\partial{m_q}}\left(-\sum_{j=1}G_{ij}m_j\right) = 0
$$

> [!NOTE]
> The term $\frac{\partial}{\partial{m_q}}\left(\sum_{j=1}G_{ij}m_j\right)$ can be written as,
> $$
> \sum_{j=1} G_{ij} \left(\frac{\partial{m_j}}{\partial{m_q}}\right)
> $$
> which is same as Kronecker delta, $\delta_{j,q}$ 

$$
\frac{\partial{E}}{\partial{m_q}} = 2\sum_{i=1} \left(d_i - \sum_{j=1}G_{ij}m_j\right)(-G_{iq}) = 0
$$
$$
\underbrace{\sum_{i=1} G_{iq}}_{G^T} \underbrace{\left( \sum_{j=1} G_{ij}m_j\right)}_{Gm} = \underbrace{\sum_{i=1}G_{iq}d_i}_{G^Td}
$$
$$
G^TGm = G^Td
$$
$$
\boxed{m_{LS} = (G^TG)^{-1}(G^Td)}
$$
## Simple problem example

Consider a 2D plan below with different velocities($V_1, V_2, \dots$). All region have same dimensions (say $k*k$). The stars(1,2,...) are the locations of earthquakes at different times. The seismic waves can only travel straight in one direction. The triangles(T_1, T_2,...) are the seismic stations which detects these seismic waves. Given the travel time, estimate the velocities in given regions. (NOTE: the waves will travel to the stations on the opposite side of the square only.)
![3.png](/img/user/ES4101-img/3.png)

**Ans.:** 

let travel time at 1 is,
$$
\frac{k}{V_1} + \frac{k}{V_2} = T_1
$$
Note here that this is not a linear problem, so we need to convert this into linear problem. To make it a linear problem define slowness instead of velocity. ($\frac{1}{V} = u$)
$$
ku_1 + ku_2 = T_1
$$
$$
u_1 + u_2 = \frac{T_1}{k}
$$
similarly for other stations, 
$$
u_3 + u_4 = \frac{T_2}{k}
$$
$$
u_1 + u_3 = \frac{T_4}{k}
$$
$$
u_2 + u_4 = \frac{T_3}{k}
$$
In matrix form, 
$$
\begin{bmatrix}
1&1&0&0 \\
0&0&1&1 \\
1&0&1&0 \\
0&1&0&1
\end{bmatrix}
\begin{bmatrix}
u_1 \\ u_2 \\ u_3 \\ u_4
\end{bmatrix}
=
\frac{1}{k}
\begin{bmatrix}
T_1 \\T_2 \\T_3 \\T_4
\end{bmatrix}
$$
this is in the form $Gm = d$.

calculate $G^TG$,
$$
\begin{bmatrix}
1&0&1&0 \\
1&0&0&1 \\
0&1&1&0 \\
0&1&0&1
\end{bmatrix}
\begin{bmatrix}
1&1&0&0 \\
0&0&1&1 \\
1&0&1&0 \\
0&1&0&1
\end{bmatrix} 
=
\begin{bmatrix}
2&1&1&0 \\
1&2&0&1 \\
1&0&2&1 \\
0&1&1&2
\end{bmatrix}
$$
but, $G^TG = 0$ so no solutions for this problem.

> [!NOTE]
> This is a Even determined problem. No. of equations = No. of parameters

